function inputHideShow(checkboxId,inputClass){checkboxId.is(":checked")?inputClass.fadeIn():inputClass.fadeOut(),checkboxId.on("click",(function(){1==jQuery(this).prop("checked")?(console.log("Checkbox is checked."),inputClass.fadeIn(500)):0==jQuery(this).prop("checked")&&(console.log("Checkbox is unchecked."),inputClass.fadeOut(500))}))}function stringShow(el,beforeSiblingEl){el.innerHTML='<span style="vertical-align:-5px;">XML генерується у фоновому режимі...</span>',el.classList.add("blinking-message"),beforeSiblingEl.classList.add("mrkv_uamrkpl_collation_btn_desabled")}function stringHide(el,beforeSiblingEl){let curDateTime=currentDateTime();el.innerHTML='<span style="vertical-align:-5px;">XML сформований у фоновому режимі. Перезавантажте сторінку. '+curDateTime+"</span>",el.classList.remove("blinking-message"),beforeSiblingEl.classList.remove("mrkv_uamrkpl_collation_btn_desabled")}function promuaBackgroundXmlCreate(){jQuery(location).attr("protocol"),jQuery(location).attr("host");const tmpXmlfileUrl=mrkvuamp_script_vars.plugin_uploads_dir_url+"tmp_"+mrkvuamp_script_vars.promua_xml_name,createXmlBtn=document.getElementById("mrkvuamp_submit_promuaxml"),loader=document.getElementById("mrkvuamp_loader");var mrkvuampPromuaSetIntervalID=setInterval((function(){let ajax=jQuery.ajax({url:tmpXmlfileUrl,headers:{"Clear-Site-Data":"cache"},type:"HEAD",cache:"no-store"});ajax.done((function(){console.log("tmp_xml file exists"),createXmlBtn.classList.add("mrkv_uamrkpl_collation_btn_desabled")})),ajax.fail((function(){console.log("tmp_xml file not exists"),stringHide(loader,createXmlBtn),clearInterval(mrkvuampPromuaSetIntervalID),isPromuaStatusJsonExists()}))}),3e4)}function currentDateTime(){let today=new Date;return(today.getDate()<10?"0":"")+today.getDate()+"-"+((today.getMonth()+1<10?"0":"")+(today.getMonth()+1))+"-"+today.getFullYear()+" "+((today.getHours()<10?"0":"")+today.getHours()+":"+((today.getMinutes()<10?"0":"")+today.getMinutes()))}function isPromuaStatusJsonExists(){const statusJsonfileUrl=mrkvuamp_script_vars.plugin_uploads_dir_url+"promua_status.json",createXmlBtn=document.getElementById("mrkvuamp_submit_promuaxml");document.getElementById("mrkvuamp_loader");console.log(statusJsonfileUrl);let ajax=jQuery.ajax({url:statusJsonfileUrl,headers:{"Clear-Site-Data":"cache"},type:"HEAD",cache:"no-store"});ajax.done((function(){console.log("json_xml file exists")})),ajax.fail((function(){console.log("json_xml file not exists"),createXmlBtn.classList.remove("mrkv_uamrkpl_collation_btn_desabled")}))}-1!==location.search.indexOf("page=mrkv_ua_marketplaces")&&jQuery(document).ready((function(){jQuery(".mrkvuamp_xml_link_copy").on("click",(function(){var fileContent,refFile=mrkvuamp_script_vars.rozetka_xml_path;jQuery.get(refFile,(function(response){fileContent=response,xmlString=(new XMLSerializer).serializeToString(fileContent);navigator.clipboard.writeText(xmlString),jQuery("input[name=mrkvuamp_clipboard]").val(xmlString).select();document.execCommand("copy"),Swal.fire({position:"center",icon:"success",title:"Скопійовано!",showConfirmButton:!1,timer:1e3})}))}));var marketplaces_checked_count=0,checkboxes_qty=jQuery("#mrkvuamp-dashboard-form .mrkvuamp_chekbox").length;jQuery("input[type=checkbox].mrkvuamp_chekbox:checked").each((function(){var status=this.checked?jQuery(this).val():"",checkboxBlock=jQuery(this).attr("id").slice("mrkvuamp_".length)+"_class";status&&(++marketplaces_checked_count,jQuery("."+checkboxBlock).css("display","none"))})),marketplaces_checked_count==checkboxes_qty&&(jQuery(".dashboard-subtitle").css("display","none"),jQuery("#mrkvuamp_dashboard_submit").css("display","none")),jQuery("#mrkvuamp_dashboard_dismiss").on("click",(function(){jQuery("#mrkvuamp_dashboard_notice").fadeOut(500),document.cookie="mrkvuamp_dashboard_notice=dismissed"}))})),-1!==location.search.indexOf("page=mrkv_ua_marketplaces_rozetka")&&window.addEventListener("load",(function(){var mrkvRozetkaNavLinks=document.querySelectorAll("ul.mrkvuamp-nav-links > li");for(let i=0;i<mrkvRozetkaNavLinks.length;i++)mrkvRozetkaNavLinks[i].addEventListener("click",mrkvSwitchLink);function mrkvSwitchLink(event){event.preventDefault(),document.querySelector("ul.mrkvuamp-nav-links li.active").classList.remove("active"),document.querySelector(".link-pane.active").classList.remove("active");var clickedLink=event.currentTarget,activePaneID=event.target.getAttribute("href");clickedLink.classList.add("active"),document.querySelector(activePaneID).classList.add("active")}})),-1!==location.search.indexOf("page=mrkv_ua_marketplaces_rozetka")&&jQuery(document).ready((function(){"your_vendor_choice"!=jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").val()&&"vendor_pwb_brand"!=jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").val()||(jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").hide(),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").hide()),"vendor_by_attributes"==jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").val()?(jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").hide(),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").css(" display","none"),jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").show(),jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").css(" display","block")):"vendor_all_possibilities"==jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").val()&&(jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").hide(),jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").css(" display","none"),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").show(),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").css(" display","block")),jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").on("change",(function(){"your_vendor_choice"!=jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").val()&&"vendor_pwb_brand"!=jQuery("#mrkv_uamrkpl_rozetka_custom_vendor").val()||(jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").hide(),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").hide()),"vendor_by_attributes"==jQuery(this).val()?(jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").fadeIn(500),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").fadeOut(500)):"vendor_all_possibilities"==jQuery(this).val()&&(jQuery(".mrkv_uamrkpl_rozetka_vendor_by_attributes_class").fadeOut(500),jQuery(".mrkv_uamrkpl_rozetka_vendor_all_possibilities_class").fadeIn(500))}))})),jQuery(document).ready((function(){jQuery(location).attr("protocol"),jQuery(location).attr("host");var siteTotalProductQty=mrkvuamp_script_vars.site_total_product_qty;if(-1!==location.search.indexOf("page=mrkv_ua_marketplaces_rozetka")){async function removeHiddenLink(){jQuery(location).attr("protocol"),jQuery(location).attr("host");jQuery.ajax({url:mrkvuamp_script_vars.rozetka_xml_path,headers:{"Clear-Site-Data":"cache"},type:"HEAD",cache:!1,error:function(){jQuery(".mrkvuamp_progress_bar").removeClass("hidden"),localStorage.getItem("mrkvuamp_collation_submit")||jQuery(".mrkvuamp_progress_bar").addClass("hidden"),jQuery(".mrkvuamp_collation_xml_link").addClass("hidden")}})}jQuery("#mrkv_uamrkpl_collation_form").on("submit",(async function(event){event.preventDefault();var jsStart=Number((new Date).getTime());async function hideSpinner(){jQuery("#mrkv_uamrkpl_collation_form #mrkvuamp_submit_collation").removeClass("mrkv_uamrkpl_collation_btn_desabled"),jQuery("#mrkvuamp_loader").remove()}localStorage.setItem("mrkvuamp_collation_submit","Event"),async function(){var $form=jQuery("#mrkv_uamrkpl_collation_form"),$formData=$form.serialize();await async function($form,$formData){if(localStorage.getItem("mrkvuamp_collation_submit")){jQuery(".mrkvuamp_progress_bar").fadeIn(500);var progBarCoef=siteTotalProductQty<100?.9:2;!async function(time){var start=0,progressElement=document.getElementById("mrkvuamp-progress-xml-upload"),progBarHiddenMsg=document.getElementById("mrkvuamp_progbar_hidden_msg"),intervalId=setInterval((function(){var elem;time<start?(clearInterval(intervalId),(elem=progBarHiddenMsg).innerHTML="Ваш xml-прайс майже готовий. Після сповіщення перезавантажте сторінку і перейдіть за посиланням.",elem.classList.remove("blinking-message"),elem.style.display="block"):(progressElement.value=start,function(elem){var progressElementMax=document.getElementById("mrkvuamp-progress-xml-upload").getAttribute("max"),progressElementValue=document.getElementById("mrkvuamp-progress-xml-upload").value;elem.innerHTML="Не перезавантажуйте сторінку "+Number(progressElementMax-progressElementValue)+" сек.: processing...",elem.classList.add("blinking-message"),elem.style.display="block",localStorage.removeItem("mrkvuamp_collation_submit")}(progBarHiddenMsg)),start++}),1e3)}(Math.round(siteTotalProductQty*progBarCoef))}else jQuery(".mrkvuamp_progress_bar").fadeOut(0);var ajaxCollationRequest=jQuery.ajax({url:ajaxurl,headers:{"Clear-Site-Data":"cache","Content-Type":"application/x-www-form-urlencoded"},data:$formData,cache:!1,ifModified:!0,timeout:6e7});ajaxCollationRequest.done((function(response){!async function(message,jsTime,phpTime){Swal.fire({position:"center",icon:"success",title:message,html:"<p>Загальний час: "+jsTime+" сек.<br>Час PHP: "+phpTime+" сек.<br>Перезавантажте сторінку.</p>",allowOutsideClick:!0})}("XML-прайс створений!",((Number((new Date).getTime())-jsStart)/1e3).toFixed(2),response.rozetka_xml_created_event),hideSpinner(),jQuery(".mrkvuamp_progress_bar").fadeOut(500)})),ajaxCollationRequest.fail((function(jqXHR,textStatus){jQuery(".mrkvuamp_progress_bar").fadeOut();var errMsg=jQuery(jqXHR.responseText),errTitle=("undefined"!=errMsg.html()&&errMsg.html(),"<p>"+errMsg.html()+"</p>");!async function(status,msg){Swal.fire({icon:"error",title:"Rozetka xml: Oops...",text:"Request failed: "+status,html:msg,footer:'<div style="font-size:smaller;"><span style="font-style:italic;">Скріншот або текст помилки надішліть: </span><a href="">support@morkva.co.ua</a></div>',showConfirmButton:!1,allowOutsideClick:!0})}(textStatus,jqXHR.responseText+errTitle),hideSpinner()}))}(0,$formData),await async function(){Swal.fire({position:"center",icon:"success",title:"XML-прайс створюється...",showConfirmButton:!1,timer:2e3,allowOutsideClick:!0})}(),await async function(){var protocol=jQuery(location).attr("protocol"),host=jQuery(location).attr("host"),loaderUrl=protocol+"//"+host+"/wp-content/plugins/ua-marketplace/assets/images/spinner.gif",image=new Image;image.src=loaderUrl,jQuery("#mrkv_uamrkpl_collation_form #mrkvuamp_submit_collation").css({"margin-right":"10px"}),jQuery("#mrkv_uamrkpl_collation_form #mrkvuamp_submit_collation").addClass("mrkv_uamrkpl_collation_btn_desabled"),jQuery("#mrkvuamp_loader").append(image)}(),await removeHiddenLink()}()})),removeHiddenLink();siteTotalProductQty=mrkvuamp_script_vars.site_total_product_qty}})),jQuery(document).ready((function(){jQuery(location).attr("protocol"),jQuery(location).attr("host");var siteTotalProductQty=mrkvuamp_script_vars.site_total_product_qty,backgroundXmlPromuaChkbx=mrkvuamp_script_vars.background_xml_promua_chkbx;if(-1!==location.search.indexOf("page=mrkv_ua_marketplaces_promua")){async function removeHiddenLink(){jQuery(location).attr("protocol"),jQuery(location).attr("host");jQuery.ajax({url:mrkvuamp_script_vars.promua_xml_path,headers:{"Clear-Site-Data":"cache"},type:"HEAD",cache:!1,error:function(){jQuery(".mrkvuamp_promua_xml_link").addClass("hidden"),localStorage.getItem("mrkvuamp_collation_promua_submit")||jQuery(".mrkvuamp_promua_progress_bar").addClass("hidden"),jQuery(".mrkvuamp_promua_xml_link").addClass("hidden")}})}jQuery("#mrkv_uamrkpl_promuaxml_form").on("submit",(async function(event){event.preventDefault();var jsStart=Number((new Date).getTime());async function hideSpinner(){jQuery("#mrkv_uamrkpl_promuaxml_form #mrkvuamp_submit_promuaxml").removeClass("mrkv_uamrkpl_collation_btn_desabled");document.getElementById("mrkvuamp_loader").innerHTML=""}localStorage.setItem("mrkvuamp_collation_promua_submit","Event"),async function(){var $form=jQuery("#mrkv_uamrkpl_promuaxml_form"),$formData=$form.serialize();await async function($form,$formData){if(localStorage.getItem("mrkvuamp_collation_promua_submit")){jQuery(".mrkvuamp_promua_progress_bar").fadeIn(500);let $progBarCoefPromua=siteTotalProductQty<100?1.2:3.7;!async function(time){var start=0,progressPromuaElement=document.getElementById("mrkvuamp-progress-xml-upload-promua"),progBarHiddenMsg=document.getElementById("mrkvuamp_progbar_hidden_msg"),intervalId=setInterval((function(){var elem;time<start?(clearInterval(intervalId),(elem=progBarHiddenMsg).innerHTML="Ваш xml-прайс майже готовий. Після сповіщення перезавантажте сторінку і перейдіть за посиланням.",elem.classList.remove("blinking-message"),elem.style.display="block"):(progressPromuaElement.value=start,function(elem){var progressPromuaElementMax=document.getElementById("mrkvuamp-progress-xml-upload-promua").getAttribute("max"),progressPromuaElementValue=document.getElementById("mrkvuamp-progress-xml-upload-promua").value;elem.innerHTML="Не перезавантажуйте сторінку "+Number(progressPromuaElementMax-progressPromuaElementValue)+" сек.: processing...",elem.classList.add("blinking-message"),elem.style.display="block",localStorage.removeItem("mrkvuamp_collation_promua_submit")}(progBarHiddenMsg)),start++}),1e3)}(Math.round(siteTotalProductQty*$progBarCoefPromua))}else jQuery(".mrkvuamp_promua_progress_bar").fadeOut(0);var ajaxPromuaRequest=jQuery.ajax({url:ajaxurl,headers:{"Clear-Site-Data":"cache","Content-Type":"application/x-www-form-urlencoded"},data:$formData,cache:!1,ifModified:!0,timeout:6e7});ajaxPromuaRequest.done((function(response){let phpTime=response.rozetka_xml_created_event,jsTime=((Number((new Date).getTime())-jsStart)/1e3).toFixed(2),html=backgroundXmlPromuaChkbx?"":"<p>Загальний час: "+jsTime+" сек.<br>Час PHP: "+phpTime+" сек.<br>Перезавантажте сторінку.</p>";jsTime=backgroundXmlPromuaChkbx?"":jsTime,async function(message,html,jsTime,phpTime){Swal.fire({position:"center",icon:"success",title:message,html,allowOutsideClick:!0})}(backgroundXmlPromuaChkbx?'<span style="line-height:1.2">XML генерується<br>у фоновому режимі!</span>':"XML-прайс створений!",html,0,response.rozetka_xml_created_event);const createXmlBtn=document.getElementById("mrkvuamp_submit_promuaxml"),loader=document.getElementById("mrkvuamp_loader");hideSpinner(),backgroundXmlPromuaChkbx&&(stringShow(loader,createXmlBtn),promuaBackgroundXmlCreate()),jQuery(".mrkvuamp_promua_progress_bar").fadeOut(500)})),ajaxPromuaRequest.fail((function(jqXHR,textStatus){jQuery(".mrkvuamp_promua_progress_bar").fadeOut();let errMsg=jQuery(jqXHR.responseText);var errTitle=("undefined"!=errMsg.html()&&errMsg.html(),"<p>"+errMsg.html()+"</p>");!async function(status,msg){Swal.fire({icon:"error",title:"PromUA xml Oops...",text:"Request failed: "+status,html:msg,footer:'<div style="font-size:smaller;"><span style="font-style:italic;">Скріншот або текст помилки надішліть: </span><a href="">support@morkva.co.ua</a></div>',showConfirmButton:!1,allowOutsideClick:!0})}(textStatus,jqXHR.responseText+errTitle),hideSpinner()}))}(0,$formData),await async function(){Swal.fire({position:"center",icon:"success",title:"XML-прайс створюється...",showConfirmButton:!1,timer:2e3,allowOutsideClick:!0})}(),await async function(){var protocol=jQuery(location).attr("protocol"),host=jQuery(location).attr("host"),loaderUrl=protocol+"//"+host+"/wp-content/plugins/ua-marketplace/assets/images/spinner.gif",image=new Image;image.src=loaderUrl,jQuery("#mrkv_uamrkpl_promuaxml_form #mrkvuamp_submit_promuaxml").css({"margin-right":"10px"}),jQuery("#mrkv_uamrkpl_promuaxml_form #mrkvuamp_submit_promuaxml").addClass("mrkv_uamrkpl_collation_btn_desabled"),jQuery("#mrkvuamp_loader").append(image)}(),await removeHiddenLink()}()})),removeHiddenLink();siteTotalProductQty=mrkvuamp_script_vars.site_total_product_qty}})),-1!==location.search.indexOf("page=mrkv_ua_marketplaces_promua")&&jQuery(document).ready((function(){inputHideShow(jQuery("#mrkv_uamrkpl_promua_background_proc_xml_chk"),jQuery(".mrkv_uamrkpl_promua_background_proc_xml_step_class")),"your_vendor_choice"!=jQuery("#mrkv_uamrkpl_promua_custom_vendor").val()&&"vendor_pwb_brand"!=jQuery("#mrkv_uamrkpl_promua_custom_vendor").val()||(jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").hide(),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").hide()),"vendor_by_attributes"==jQuery("#mrkv_uamrkpl_promua_custom_vendor").val()?(jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").hide(),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").css(" display","none"),jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").show(),jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").css(" display","block")):"vendor_all_possibilities"==jQuery("#mrkv_uamrkpl_promua_custom_vendor").val()&&(jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").hide(),jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").css(" display","none"),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").show(),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").css(" display","block")),jQuery("#mrkv_uamrkpl_promua_custom_vendor").on("change",(function(){"your_vendor_choice"!=jQuery("#mrkv_uamrkpl_promua_custom_vendor").val()&&"vendor_pwb_brand"!=jQuery("#mrkv_uamrkpl_promua_custom_vendor").val()||(jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").hide(),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").hide()),"vendor_by_attributes"==jQuery(this).val()?(jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").fadeIn(500),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").fadeOut(500)):"vendor_all_possibilities"==jQuery(this).val()&&(jQuery(".mrkv_uamrkpl_promua_vendor_by_attributes_class").fadeOut(500),jQuery(".mrkv_uamrkpl_promua_vendor_all_possibilities_class").fadeIn(500))}))}));